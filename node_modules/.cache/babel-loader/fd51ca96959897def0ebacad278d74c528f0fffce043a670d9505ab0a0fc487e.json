{"ast":null,"code":"var _jsxFileName = \"/home/miruto20/Documents/Proyectos/instagram.Proy.Beta.Front/front.instagram/src/page/EditProfilePage/index.js\",\n  _s = $RefreshSig$();\nimport \"./style.css\";\nimport { useTokenContext } from \"../../context/TokenContext\";\nimport Avatar from \"../../components/Avatar\";\nimport getTimeAgo from \"../../utils/getTimeAgo\";\nimport { useState, useRef } from \"react\";\nimport Modal from \"../../components/Modal/index\";\nimport { toast } from \"react-toastify\";\nimport { useNavigate } from \"react-router-dom\";\nimport PassButton from \"../../components/PassButton\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst EditProfilePage = () => {\n  _s();\n  const {\n    loggedUser\n  } = useTokenContext();\n  const {\n    username,\n    createdAt,\n    email\n  } = loggedUser;\n  const navigate = useNavigate();\n  const [errorMessage, SetErrorMessage] = useState(\"\");\n  const imagesInputRef = useRef();\n  const [showModal, setShowModal] = useState(false);\n  // const [cambioContraseña, setCambioContraseña] = useState(false);\n  const {\n    token\n  } = useTokenContext();\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \" Profile \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"article\", {\n      children: [/*#__PURE__*/_jsxDEV(Avatar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 26,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: async event => {\n          try {\n            event.preventDefault();\n            const imagenAvatar = imagesInputRef.current.files[0];\n            console.log(imagenAvatar);\n            const formData = new FormData();\n            formData.set(\"avatar\", imagenAvatar);\n\n            /*  Cuando hacemos una entrada le pasamos imagesInputRef.Current.files ...puede contener varias fotos arrai, pero aqui le pasamos la primera posicion SIEMPRE no un array \n            if (imagenAvatar.length) {\n              for (const image of imagenAvatar) {\n                formData.set(\"avatar\", image);\n              }\n             } */\n            const res = await fetch(\"http://localhost:4000/users/avatar\", {\n              method: \"PUT\",\n              headers: {\n                Authorization: token\n              },\n              body: formData\n            });\n            console.log(res);\n            const body = await res.json();\n            console.log(body);\n            if (!res.ok) {\n              throw new Error(body.message);\n            }\n            navigate(\"/\");\n          } catch (error) {\n            console.error(error);\n            SetErrorMessage(error.message);\n          }\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"image\",\n          children: \"Seleccionar imagen\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 63,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"image\",\n          type: \"file\",\n          required: true,\n          accept: \"image/*\",\n          ref: imagesInputRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          children: \"Confirmar cambio\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 27,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: [\"Nombre de Usuario:\", username]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 73,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: [\"email: \", email]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 74,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\" se uni\\xF3: \", getTimeAgo(new Date(createdAt))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 75,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          setShowModal(true);\n        },\n        children: \"Cambiar contrase\\xF1a\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 25,\n      columnNumber: 7\n    }, this), showModal && /*#__PURE__*/_jsxDEV(Modal, {\n      setShowModal: setShowModal,\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Se te va a enviar un email con un c\\xF3digo para cambiar la contrase\\xF1a. \\xBFEst\\xE1s seguro de qu\\xE9 quieres modificarla?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          setShowModal(false);\n        },\n        children: \"Cancelar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 91,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(PassButton, {\n        email: email,\n        setShowModal: setShowModal\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 9\n    }, this), \" \"]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 23,\n    columnNumber: 5\n  }, this);\n};\n_s(EditProfilePage, \"EC5saJE4cA9wKJzeGtarhCo6cWA=\", false, function () {\n  return [useTokenContext, useNavigate, useTokenContext];\n});\n_c = EditProfilePage;\nexport default EditProfilePage;\nvar _c;\n$RefreshReg$(_c, \"EditProfilePage\");","map":{"version":3,"names":["useTokenContext","Avatar","getTimeAgo","useState","useRef","Modal","toast","useNavigate","PassButton","EditProfilePage","loggedUser","username","createdAt","email","navigate","errorMessage","SetErrorMessage","imagesInputRef","showModal","setShowModal","token","event","preventDefault","imagenAvatar","current","files","console","log","formData","FormData","set","res","fetch","method","headers","Authorization","body","json","ok","Error","message","error","Date"],"sources":["/home/miruto20/Documents/Proyectos/instagram.Proy.Beta.Front/front.instagram/src/page/EditProfilePage/index.js"],"sourcesContent":["import \"./style.css\";\nimport { useTokenContext } from \"../../context/TokenContext\";\nimport Avatar from \"../../components/Avatar\";\nimport getTimeAgo from \"../../utils/getTimeAgo\";\nimport { useState, useRef } from \"react\";\nimport Modal from \"../../components/Modal/index\";\nimport { toast } from \"react-toastify\";\nimport { useNavigate } from \"react-router-dom\";\nimport PassButton from \"../../components/PassButton\";\n\nconst EditProfilePage = () => {\n  const { loggedUser } = useTokenContext();\n  const { username, createdAt, email } = loggedUser;\n  const navigate = useNavigate();\n  const [errorMessage, SetErrorMessage] = useState(\"\");\n\n  const imagesInputRef = useRef();\n\n  const [showModal, setShowModal] = useState(false);\n  // const [cambioContraseña, setCambioContraseña] = useState(false);\n  const { token } = useTokenContext();\n  return (\n    <section>\n      <h2> Profile </h2>\n      <article>\n        <Avatar />\n        <form\n          onSubmit={async (event) => {\n            try {\n              event.preventDefault();\n              const imagenAvatar = imagesInputRef.current.files[0];\n              console.log(imagenAvatar);\n\n              const formData = new FormData();\n              formData.set(\"avatar\", imagenAvatar);\n\n              /*  Cuando hacemos una entrada le pasamos imagesInputRef.Current.files ...puede contener varias fotos arrai, pero aqui le pasamos la primera posicion SIEMPRE no un array \n              if (imagenAvatar.length) {\n                for (const image of imagenAvatar) {\n                  formData.set(\"avatar\", image);\n                }\n\n              } */\n              const res = await fetch(\"http://localhost:4000/users/avatar\", {\n                method: \"PUT\",\n                headers: { Authorization: token },\n                body: formData,\n              });\n              console.log(res);\n              const body = await res.json();\n              console.log(body);\n\n              if (!res.ok) {\n                throw new Error(body.message);\n              }\n              navigate(\"/\");\n            } catch (error) {\n              console.error(error);\n              SetErrorMessage(error.message);\n            }\n          }}\n        >\n          <label htmlFor=\"image\">Seleccionar imagen</label>\n          <input\n            id=\"image\"\n            type=\"file\"\n            required\n            accept=\"image/*\"\n            ref={imagesInputRef}\n          ></input>\n          <button>Confirmar cambio</button>\n        </form>\n        <h3>Nombre de Usuario:{username}</h3>\n        <h4>email: {email}</h4>\n        <p> se unió: {getTimeAgo(new Date(createdAt))}</p>\n        <button\n          onClick={() => {\n            setShowModal(true);\n          }}\n        >\n          Cambiar contraseña\n        </button>\n      </article>\n      {showModal && (\n        <Modal setShowModal={setShowModal}>\n          <p>\n            Se te va a enviar un email con un código para cambiar la contraseña.\n            ¿Estás seguro de qué quieres modificarla?\n          </p>\n\n          <button\n            onClick={() => {\n              setShowModal(false);\n            }}\n          >\n            Cancelar\n          </button>\n          <PassButton email={email} setShowModal={setShowModal} />\n\n          {/*    <button\n            //fetch para solicitar que te envíe un correo con una nueva contraseña\n            onClick={async () => {\n              try {\n                const res = await fetch(\n                  \"http://localhost:4000/users/password/recover\",\n                  {\n                    method: \"POST\",\n                    body: JSON.stringify({ email }),\n                    headers: { \"Content-Type\": \"application/json\" },\n                  }\n                );\n\n                const body = await res.json();\n                console.log(body);\n\n                if (!res.ok) {\n                  throw new Error(body.message);\n                }\n\n                // setCambioContraseña(true);\n                navigate(\"/login\");\n\n                toast.success(body.message);\n              } catch (error) {\n                console.error(error);\n                toast.error(error.message);\n              } finally {\n                setShowModal(false);\n              }\n            }}\n          >\n            Sí, cambiar contraseña\n          </button> */}\n        </Modal>\n      )}{\" \"}\n    </section>\n  );\n};\n\nexport default EditProfilePage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}