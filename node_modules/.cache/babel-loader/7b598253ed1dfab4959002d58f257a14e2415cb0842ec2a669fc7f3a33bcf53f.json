{"ast":null,"code":"var _jsxFileName = \"/home/miruto20/Documents/Proyectos/instagram.Proy.Beta.Front/front.instagram/src/page/EditProfilePage.js\",\n  _s = $RefreshSig$();\nimport { useTokenContext } from \"../context/TokenContext\";\nimport Avatar from \"../components/Avatar\";\nimport getTimeAgo from \"../utils/getTimeAgo\";\nimport { useState, useRef } from \"react\";\nimport Modal from \"../components/Modal/index\";\nimport { toast } from \"react-toastify\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst [errorMessage, SetErrorMessage] = useState(\"\");\nconst EditProfilePage = () => {\n  _s();\n  const {\n    loggedUser\n  } = useTokenContext();\n  const {\n    username,\n    createdAt,\n    email\n  } = loggedUser;\n  const navigate = useNavigate();\n  const imagesInputRef = useRef();\n  const [showModal, setShowModal] = useState(false);\n  // const [cambioContraseña, setCambioContraseña] = useState(false);\n  const {\n    token\n  } = useTokenContext();\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \" Profile \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 23,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"article\", {\n      children: [/*#__PURE__*/_jsxDEV(Avatar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 25,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: async event => {\n          try {\n            event.preventDefault();\n            const images = imagesInputRef.current.files;\n            const formData = new FormData();\n            if (images.length) {\n              for (const image of images) {\n                formData.set(image.name, image);\n              }\n            }\n            const res = await fetch(\"http://localhost:4000/users/avatar\", {\n              method: \"POST\",\n              headers: {\n                Authorization: token\n              },\n              body: formData\n            });\n            const body = await res.json();\n            if (!res.ok) {\n              throw new Error(body.message);\n            }\n            navigate(\"/\");\n          } catch (error) {\n            console.error(error);\n            SetErrorMessage(error.message);\n          }\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"image\",\n          children: \"Imagen\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 58,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"image\",\n          type: \"file\",\n          multiple: true,\n          required: true,\n          accept: \"image/*\",\n          ref: imagesInputRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 59,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 26,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: [\"Nombre de Usuario:\", username]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: [\"email: \", email]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\" se uni\\xF3: \", getTimeAgo(new Date(createdAt))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          setShowModal(true);\n        },\n        children: \"Cambiar contrase\\xF1a\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 7\n    }, this), showModal && /*#__PURE__*/_jsxDEV(Modal, {\n      setShowModal: setShowModal,\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Se te va a enviar un email con un c\\xF3digo para cambiar la contrase\\xF1a. \\xBFEst\\xE1s seguro de qu\\xE9 quieres modificarla?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 81,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          setShowModal(false);\n        },\n        children: \"Cancelar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        //fetch para solicitar que te envíe un correo con una nueva contraseña\n        onClick: async () => {\n          try {\n            const res = await fetch(\"http://localhost:4000/users/password/recover\", {\n              method: \"POST\",\n              body: JSON.stringify({\n                email\n              }),\n              headers: {\n                \"Content-Type\": \"application/json\"\n              }\n            });\n            const body = await res.json();\n            console.log(body);\n            if (!res.ok) {\n              throw new Error(body.message);\n            }\n\n            // setCambioContraseña(true);\n            navigate(\"/login\");\n            toast.success(body.message);\n          } catch (error) {\n            console.error(error);\n            toast.error(error.message);\n          } finally {\n            setShowModal(false);\n          }\n        },\n        children: \"S\\xED, cambiar contrase\\xF1a\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 94,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 9\n    }, this), \" \"]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 22,\n    columnNumber: 5\n  }, this);\n};\n_s(EditProfilePage, \"Z5z3cITR9iQkHW0W4dfoBGvJw4s=\", false, function () {\n  return [useTokenContext, useNavigate, useTokenContext];\n});\n_c = EditProfilePage;\nexport default EditProfilePage;\nvar _c;\n$RefreshReg$(_c, \"EditProfilePage\");","map":{"version":3,"names":["useTokenContext","Avatar","getTimeAgo","useState","useRef","Modal","toast","useParams","useNavigate","errorMessage","SetErrorMessage","EditProfilePage","loggedUser","username","createdAt","email","navigate","imagesInputRef","showModal","setShowModal","token","event","preventDefault","images","current","files","formData","FormData","length","image","set","name","res","fetch","method","headers","Authorization","body","json","ok","Error","message","error","console","Date","JSON","stringify","log","success"],"sources":["/home/miruto20/Documents/Proyectos/instagram.Proy.Beta.Front/front.instagram/src/page/EditProfilePage.js"],"sourcesContent":["import { useTokenContext } from \"../context/TokenContext\";\nimport Avatar from \"../components/Avatar\";\nimport getTimeAgo from \"../utils/getTimeAgo\";\nimport { useState, useRef } from \"react\";\nimport Modal from \"../components/Modal/index\";\nimport { toast } from \"react-toastify\";\nimport { useParams, useNavigate } from \"react-router-dom\";\nconst [errorMessage, SetErrorMessage] = useState(\"\");\n\nconst EditProfilePage = () => {\n  const { loggedUser } = useTokenContext();\n  const { username, createdAt, email } = loggedUser;\n  const navigate = useNavigate();\n\n  const imagesInputRef = useRef();\n\n  const [showModal, setShowModal] = useState(false);\n  // const [cambioContraseña, setCambioContraseña] = useState(false);\n  const { token } = useTokenContext();\n\n  return (\n    <section>\n      <h2> Profile </h2>\n      <article>\n        <Avatar />\n        <form\n          onSubmit={async (event) => {\n            try {\n              event.preventDefault();\n              const images = imagesInputRef.current.files;\n\n              const formData = new FormData();\n\n              if (images.length) {\n                for (const image of images) {\n                  formData.set(image.name, image);\n                }\n              }\n\n              const res = await fetch(\"http://localhost:4000/users/avatar\", {\n                method: \"POST\",\n                headers: { Authorization: token },\n                body: formData,\n              });\n\n              const body = await res.json();\n\n              if (!res.ok) {\n                throw new Error(body.message);\n              }\n              navigate(\"/\");\n            } catch (error) {\n              console.error(error);\n              SetErrorMessage(error.message);\n            }\n          }}\n        >\n          <label htmlFor=\"image\">Imagen</label>\n          <input\n            id=\"image\"\n            type=\"file\"\n            multiple\n            required\n            accept=\"image/*\"\n            ref={imagesInputRef}\n          ></input>\n        </form>\n        <h3>Nombre de Usuario:{username}</h3>\n        <h4>email: {email}</h4>\n        <p> se unió: {getTimeAgo(new Date(createdAt))}</p>\n        <button\n          onClick={() => {\n            setShowModal(true);\n          }}\n        >\n          Cambiar contraseña\n        </button>\n      </article>\n      {showModal && (\n        <Modal setShowModal={setShowModal}>\n          <p>\n            Se te va a enviar un email con un código para cambiar la contraseña.\n            ¿Estás seguro de qué quieres modificarla?\n          </p>\n\n          <button\n            onClick={() => {\n              setShowModal(false);\n            }}\n          >\n            Cancelar\n          </button>\n\n          <button\n            //fetch para solicitar que te envíe un correo con una nueva contraseña\n            onClick={async () => {\n              try {\n                const res = await fetch(\n                  \"http://localhost:4000/users/password/recover\",\n                  {\n                    method: \"POST\",\n                    body: JSON.stringify({ email }),\n                    headers: { \"Content-Type\": \"application/json\" },\n                  }\n                );\n\n                const body = await res.json();\n                console.log(body);\n\n                if (!res.ok) {\n                  throw new Error(body.message);\n                }\n\n                // setCambioContraseña(true);\n                navigate(\"/login\");\n\n                toast.success(body.message);\n              } catch (error) {\n                console.error(error);\n                toast.error(error.message);\n              } finally {\n                setShowModal(false);\n              }\n            }}\n          >\n            Sí, cambiar contraseña\n          </button>\n        </Modal>\n      )}{\" \"}\n    </section>\n  );\n};\n\nexport default EditProfilePage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}