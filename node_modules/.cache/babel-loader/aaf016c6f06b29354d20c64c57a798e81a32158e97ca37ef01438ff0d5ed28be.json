{"ast":null,"code":"var _jsxFileName = \"/home/miruto20/Documents/Proyectos/instagram.Proy.Beta.Front/front.instagram/src/page/EditProfilePage/index.js\",\n  _s = $RefreshSig$();\nimport \"./style.css\";\nimport { useTokenContext } from \"../../context/TokenContext\";\nimport Avatar from \"../../components/Avatar\";\nimport getTimeAgo from \"../../utils/getTimeAgo\";\nimport { useState, useRef } from \"react\";\nimport Modal from \"../../components/Modal/index\";\nimport { toast } from \"react-toastify\";\nimport { useNavigate, Navigate } from \"react-router-dom\";\nimport PassButton from \"../../components/PassButton/index\";\nimport EmailButton from \"../../components/EmailButton\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst EditProfilePage = () => {\n  _s();\n  const {\n    loggedUser\n  } = useTokenContext();\n  const {\n    username,\n    createdAt,\n    email\n  } = loggedUser;\n  const navigate = useNavigate();\n  const [errorMessage, SetErrorMessage] = useState(\"\");\n  const imagesInputRef = useRef();\n  const [showModal, setShowModal] = useState(false);\n  const [showMailModal, setShowMailModal] = useState(false);\n  const [newEmail, setNewEmail] = useState(\"\");\n\n  // const [cambioContraseña, setCambioContraseña] = useState(false);\n  const {\n    token\n  } = useTokenContext();\n  if (!token) {\n    return /*#__PURE__*/_jsxDEV(Navigate, {\n      to: \"/login\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 26,\n      columnNumber: 12\n    }, this);\n  }\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    className: \"editProfileSect\",\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      className: \"usernameH2EditProfile\",\n      children: [\" \", username]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 31,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"article\", {\n      className: \"articleEditProfile\",\n      children: [/*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: async event => {\n          /*#__PURE__*/_jsxDEV(\"h3\", {\n            children: username\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 35,\n            columnNumber: 13\n          }, this);\n          try {\n            event.preventDefault();\n            const imagenAvatar = imagesInputRef.current.files[0];\n            console.log(imagenAvatar);\n            const formData = new FormData();\n            formData.set(\"avatar\", imagenAvatar);\n\n            /*  Cuando hacemos una entrada le pasamos imagesInputRef.Current.files ...puede contener varias fotos arrai, pero aqui le pasamos la primera posicion SIEMPRE no un array \n            if (imagenAvatar.length) {\n              for (const image of imagenAvatar) {\n                formData.set(\"avatar\", image);\n              }\n             } */\n            const res = await fetch(\"http://localhost:4000/users/avatar\", {\n              method: \"PUT\",\n              headers: {\n                Authorization: token\n              },\n              body: formData\n            });\n            console.log(res);\n            const body = await res.json();\n            console.log(body);\n            if (!res.ok) {\n              throw new Error(body.message);\n            }\n            navigate(\"/\");\n          } catch (error) {\n            console.error(error);\n            SetErrorMessage(error.message);\n          }\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"image\",\n          children: /*#__PURE__*/_jsxDEV(Avatar, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 70,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"image\",\n          type: \"file\",\n          required: true,\n          accept: \"image/*\",\n          ref: imagesInputRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 73,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          children: \"Confirmar cambio\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 33,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"emailH4EditProfile\",\n        children: [\"email: \", email]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 82,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"emailButtonEditProfile\",\n        onClick: () => {\n          setShowMailModal(true);\n        },\n        children: \"Cambiar Email\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 83,\n        columnNumber: 9\n      }, this), showMailModal && /*#__PURE__*/_jsxDEV(Modal, {\n        setShowModal: setShowMailModal,\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: \"\\xBFEst\\xE1s seguro de qu\\xE9 quieres modificarlo? Una vez hagas esto, se te desactivar\\xE1 la cuenta hasta que confirmes en tu nuevo mail. Se te va a enviar un correo con un c\\xF3digo de activacion para cambiar el Email. En caso de algun problema contacte con soporte. Un cordial saludo.\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"newEmail\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"newEmail\",\n          type: \"email\",\n          required: true,\n          value: newEmail,\n          onChange: event => {\n            setNewEmail(event.target.value);\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          onClick: () => {\n            setShowMailModal(false);\n          },\n          children: \"Cancelar\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 110,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(EmailButton, {\n          email: email,\n          setShowMailModal: setShowMailModal,\n          newEmail: newEmail\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"pTimeEditProfile\",\n        children: [\" \", \"se uni\\xF3: \", getTimeAgo(new Date(createdAt))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          setShowModal(true);\n        },\n        children: \"Cambiar contrase\\xF1a\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 129,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 32,\n      columnNumber: 7\n    }, this), showModal && /*#__PURE__*/_jsxDEV(Modal, {\n      setShowModal: setShowModal,\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Se te va a enviar un email con un c\\xF3digo para cambiar la contrase\\xF1a. \\xBFEst\\xE1s seguro de qu\\xE9 quieres modificarla?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          setShowModal(false);\n        },\n        children: \"Cancelar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(PassButton, {\n        email: email,\n        setShowModal: setShowModal\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 30,\n    columnNumber: 5\n  }, this);\n};\n_s(EditProfilePage, \"hWKqBRvq+6Af8/dv78IpuAQwG+I=\", false, function () {\n  return [useTokenContext, useNavigate, useTokenContext];\n});\n_c = EditProfilePage;\nexport default EditProfilePage;\nvar _c;\n$RefreshReg$(_c, \"EditProfilePage\");","map":{"version":3,"names":["useTokenContext","Avatar","getTimeAgo","useState","useRef","Modal","toast","useNavigate","Navigate","PassButton","EmailButton","EditProfilePage","loggedUser","username","createdAt","email","navigate","errorMessage","SetErrorMessage","imagesInputRef","showModal","setShowModal","showMailModal","setShowMailModal","newEmail","setNewEmail","token","event","preventDefault","imagenAvatar","current","files","console","log","formData","FormData","set","res","fetch","method","headers","Authorization","body","json","ok","Error","message","error","target","value","Date"],"sources":["/home/miruto20/Documents/Proyectos/instagram.Proy.Beta.Front/front.instagram/src/page/EditProfilePage/index.js"],"sourcesContent":["import \"./style.css\";\nimport { useTokenContext } from \"../../context/TokenContext\";\nimport Avatar from \"../../components/Avatar\";\nimport getTimeAgo from \"../../utils/getTimeAgo\";\nimport { useState, useRef } from \"react\";\nimport Modal from \"../../components/Modal/index\";\nimport { toast } from \"react-toastify\";\nimport { useNavigate, Navigate } from \"react-router-dom\";\nimport PassButton from \"../../components/PassButton/index\";\nimport EmailButton from \"../../components/EmailButton\";\nconst EditProfilePage = () => {\n  const { loggedUser } = useTokenContext();\n  const { username, createdAt, email } = loggedUser;\n  const navigate = useNavigate();\n  const [errorMessage, SetErrorMessage] = useState(\"\");\n\n  const imagesInputRef = useRef();\n\n  const [showModal, setShowModal] = useState(false);\n  const [showMailModal, setShowMailModal] = useState(false);\n  const [newEmail, setNewEmail] = useState(\"\");\n\n  // const [cambioContraseña, setCambioContraseña] = useState(false);\n  const { token } = useTokenContext();\n  if (!token) {\n    return <Navigate to=\"/login\" />;\n  }\n\n  return (\n    <section className=\"editProfileSect\">\n      <h2 className=\"usernameH2EditProfile\"> {username}</h2>\n      <article className=\"articleEditProfile\">\n        <form\n          onSubmit={async (event) => {\n            <h3>{username}</h3>;\n            try {\n              event.preventDefault();\n              const imagenAvatar = imagesInputRef.current.files[0];\n              console.log(imagenAvatar);\n\n              const formData = new FormData();\n              formData.set(\"avatar\", imagenAvatar);\n\n              /*  Cuando hacemos una entrada le pasamos imagesInputRef.Current.files ...puede contener varias fotos arrai, pero aqui le pasamos la primera posicion SIEMPRE no un array \n              if (imagenAvatar.length) {\n                for (const image of imagenAvatar) {\n                  formData.set(\"avatar\", image);\n                }\n\n              } */\n              const res = await fetch(\"http://localhost:4000/users/avatar\", {\n                method: \"PUT\",\n                headers: { Authorization: token },\n                body: formData,\n              });\n              console.log(res);\n              const body = await res.json();\n              console.log(body);\n\n              if (!res.ok) {\n                throw new Error(body.message);\n              }\n              navigate(\"/\");\n            } catch (error) {\n              console.error(error);\n              SetErrorMessage(error.message);\n            }\n          }}\n        >\n          <label htmlFor=\"image\">\n            <Avatar />\n          </label>\n          <input\n            id=\"image\"\n            type=\"file\"\n            required\n            accept=\"image/*\"\n            ref={imagesInputRef}\n          ></input>\n          <button>Confirmar cambio</button>\n        </form>\n        <h4 className=\"emailH4EditProfile\">email: {email}</h4>\n        <button\n          className=\"emailButtonEditProfile\"\n          onClick={() => {\n            setShowMailModal(true);\n          }}\n        >\n          Cambiar Email\n        </button>\n        {showMailModal && (\n          <Modal setShowModal={setShowMailModal}>\n            <p>\n              ¿Estás seguro de qué quieres modificarlo? Una vez hagas esto, se\n              te desactivará la cuenta hasta que confirmes en tu nuevo mail. Se\n              te va a enviar un correo con un código de activacion para cambiar\n              el Email. En caso de algun problema contacte con soporte. Un\n              cordial saludo.\n            </p>\n            <label htmlFor=\"newEmail\" />\n            <input\n              id=\"newEmail\"\n              type=\"email\"\n              required\n              value={newEmail}\n              onChange={(event) => {\n                setNewEmail(event.target.value);\n              }}\n            />\n            <button\n              onClick={() => {\n                setShowMailModal(false);\n              }}\n            >\n              Cancelar\n            </button>\n            <EmailButton\n              email={email}\n              setShowMailModal={setShowMailModal}\n              newEmail={newEmail}\n            />\n          </Modal>\n        )}\n\n        <p className=\"pTimeEditProfile\">\n          {\" \"}\n          se unió: {getTimeAgo(new Date(createdAt))}\n        </p>\n        <button\n          onClick={() => {\n            setShowModal(true);\n          }}\n        >\n          Cambiar contraseña\n        </button>\n      </article>\n      {showModal && (\n        <Modal setShowModal={setShowModal}>\n          <p>\n            Se te va a enviar un email con un código para cambiar la contraseña.\n            ¿Estás seguro de qué quieres modificarla?\n          </p>\n\n          <button\n            onClick={() => {\n              setShowModal(false);\n            }}\n          >\n            Cancelar\n          </button>\n          <PassButton email={email} setShowModal={setShowModal} />\n        </Modal>\n      )}\n    </section>\n  );\n};\n\nexport default EditProfilePage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}