{"ast":null,"code":"var _jsxFileName = \"/home/miruto20/Documents/Proyectos/instagram.Proy.Beta.Front/front.instagram/src/page/EditProfilePage.js\",\n  _s = $RefreshSig$();\nimport { useTokenContext } from \"../context/TokenContext\";\nimport Avatar from \"../components/Avatar\";\nimport getTimeAgo from \"../utils/getTimeAgo\";\nimport { useState, useRef } from \"react\";\nimport Modal from \"../components/Modal/index\";\nimport { toast } from \"react-toastify\";\nimport { useNavigate } from \"react-router-dom\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst EditProfilePage = () => {\n  _s();\n  const {\n    loggedUser\n  } = useTokenContext();\n  const {\n    username,\n    createdAt,\n    email\n  } = loggedUser;\n  const navigate = useNavigate();\n  const [errorMessage, SetErrorMessage] = useState(\"\");\n  const imagesInputRef = useRef();\n  const [showModal, setShowModal] = useState(false);\n  // const [cambioContraseña, setCambioContraseña] = useState(false);\n  const {\n    token\n  } = useTokenContext();\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \" Profile \"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 23,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"article\", {\n      children: [/*#__PURE__*/_jsxDEV(Avatar, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 25,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n        onSubmit: async event => {\n          try {\n            event.preventDefault();\n            const imagenAvatar = imagesInputRef.current.files;\n            console.log(images);\n            const formData = new FormData();\n            formData.set(\"avatar\", imagenAvatar);\n            const res = await fetch(\"http://localhost:4000/users/avatar\", {\n              method: \"PUT\",\n              headers: {\n                Authorization: token\n              },\n              body: formData\n            });\n            console.log(res);\n            const body = await res.json();\n            console.log(body);\n            if (!res.ok) {\n              throw new Error(body.message);\n            }\n            navigate(\"/\");\n          } catch (error) {\n            console.error(error);\n            SetErrorMessage(error.message);\n          }\n        },\n        children: [/*#__PURE__*/_jsxDEV(\"label\", {\n          htmlFor: \"image\",\n          children: \"Imagen\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 56,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n          id: \"image\",\n          type: \"file\",\n          required: true,\n          accept: \"image/*\",\n          ref: imagesInputRef\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 57,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          children: \"Cambiar Foto\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 64,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 26,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        children: [\"Nombre de Usuario:\", username]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 66,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: [\"email: \", email]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 67,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        children: [\" se uni\\xF3: \", getTimeAgo(new Date(createdAt))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 68,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          setShowModal(true);\n        },\n        children: \"Cambiar contrase\\xF1a\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 69,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 24,\n      columnNumber: 7\n    }, this), showModal && /*#__PURE__*/_jsxDEV(Modal, {\n      setShowModal: setShowModal,\n      children: [/*#__PURE__*/_jsxDEV(\"p\", {\n        children: \"Se te va a enviar un email con un c\\xF3digo para cambiar la contrase\\xF1a. \\xBFEst\\xE1s seguro de qu\\xE9 quieres modificarla?\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 79,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => {\n          setShowModal(false);\n        },\n        children: \"Cancelar\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 84,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        //fetch para solicitar que te envíe un correo con una nueva contraseña\n        onClick: async () => {\n          try {\n            const res = await fetch(\"http://localhost:4000/users/password/recover\", {\n              method: \"POST\",\n              body: JSON.stringify({\n                email\n              }),\n              headers: {\n                \"Content-Type\": \"application/json\"\n              }\n            });\n            const body = await res.json();\n            console.log(body);\n            if (!res.ok) {\n              throw new Error(body.message);\n            }\n\n            // setCambioContraseña(true);\n            navigate(\"/login\");\n            toast.success(body.message);\n          } catch (error) {\n            console.error(error);\n            toast.error(error.message);\n          } finally {\n            setShowModal(false);\n          }\n        },\n        children: \"S\\xED, cambiar contrase\\xF1a\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 9\n    }, this), \" \"]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 22,\n    columnNumber: 5\n  }, this);\n};\n_s(EditProfilePage, \"EC5saJE4cA9wKJzeGtarhCo6cWA=\", false, function () {\n  return [useTokenContext, useNavigate, useTokenContext];\n});\n_c = EditProfilePage;\nexport default EditProfilePage;\nvar _c;\n$RefreshReg$(_c, \"EditProfilePage\");","map":{"version":3,"names":["useTokenContext","Avatar","getTimeAgo","useState","useRef","Modal","toast","useNavigate","EditProfilePage","loggedUser","username","createdAt","email","navigate","errorMessage","SetErrorMessage","imagesInputRef","showModal","setShowModal","token","event","preventDefault","imagenAvatar","current","files","console","log","images","formData","FormData","set","res","fetch","method","headers","Authorization","body","json","ok","Error","message","error","Date","JSON","stringify","success"],"sources":["/home/miruto20/Documents/Proyectos/instagram.Proy.Beta.Front/front.instagram/src/page/EditProfilePage.js"],"sourcesContent":["import { useTokenContext } from \"../context/TokenContext\";\nimport Avatar from \"../components/Avatar\";\nimport getTimeAgo from \"../utils/getTimeAgo\";\nimport { useState, useRef } from \"react\";\nimport Modal from \"../components/Modal/index\";\nimport { toast } from \"react-toastify\";\nimport { useNavigate } from \"react-router-dom\";\n\nconst EditProfilePage = () => {\n  const { loggedUser } = useTokenContext();\n  const { username, createdAt, email } = loggedUser;\n  const navigate = useNavigate();\n  const [errorMessage, SetErrorMessage] = useState(\"\");\n\n  const imagesInputRef = useRef();\n\n  const [showModal, setShowModal] = useState(false);\n  // const [cambioContraseña, setCambioContraseña] = useState(false);\n  const { token } = useTokenContext();\n\n  return (\n    <section>\n      <h2> Profile </h2>\n      <article>\n        <Avatar />\n        <form\n          onSubmit={async (event) => {\n            try {\n              event.preventDefault();\n              const imagenAvatar = imagesInputRef.current.files;\n              console.log(images);\n\n              const formData = new FormData();\n\n              formData.set(\"avatar\", imagenAvatar);\n\n              const res = await fetch(\"http://localhost:4000/users/avatar\", {\n                method: \"PUT\",\n                headers: { Authorization: token },\n                body: formData,\n              });\n              console.log(res);\n              const body = await res.json();\n              console.log(body);\n\n              if (!res.ok) {\n                throw new Error(body.message);\n              }\n              navigate(\"/\");\n            } catch (error) {\n              console.error(error);\n              SetErrorMessage(error.message);\n            }\n          }}\n        >\n          <label htmlFor=\"image\">Imagen</label>\n          <input\n            id=\"image\"\n            type=\"file\"\n            required\n            accept=\"image/*\"\n            ref={imagesInputRef}\n          ></input>\n          <button>Cambiar Foto</button>\n        </form>\n        <h3>Nombre de Usuario:{username}</h3>\n        <h4>email: {email}</h4>\n        <p> se unió: {getTimeAgo(new Date(createdAt))}</p>\n        <button\n          onClick={() => {\n            setShowModal(true);\n          }}\n        >\n          Cambiar contraseña\n        </button>\n      </article>\n      {showModal && (\n        <Modal setShowModal={setShowModal}>\n          <p>\n            Se te va a enviar un email con un código para cambiar la contraseña.\n            ¿Estás seguro de qué quieres modificarla?\n          </p>\n\n          <button\n            onClick={() => {\n              setShowModal(false);\n            }}\n          >\n            Cancelar\n          </button>\n\n          <button\n            //fetch para solicitar que te envíe un correo con una nueva contraseña\n            onClick={async () => {\n              try {\n                const res = await fetch(\n                  \"http://localhost:4000/users/password/recover\",\n                  {\n                    method: \"POST\",\n                    body: JSON.stringify({ email }),\n                    headers: { \"Content-Type\": \"application/json\" },\n                  }\n                );\n\n                const body = await res.json();\n                console.log(body);\n\n                if (!res.ok) {\n                  throw new Error(body.message);\n                }\n\n                // setCambioContraseña(true);\n                navigate(\"/login\");\n\n                toast.success(body.message);\n              } catch (error) {\n                console.error(error);\n                toast.error(error.message);\n              } finally {\n                setShowModal(false);\n              }\n            }}\n          >\n            Sí, cambiar contraseña\n          </button>\n        </Modal>\n      )}{\" \"}\n    </section>\n  );\n};\n\nexport default EditProfilePage;\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}